<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Remote Agent - Share Your Screen</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body class="agent-page">
  <!-- Animated Background -->
  <div class="animated-bg">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
    <div class="gradient-orb orb-3"></div>
  </div>

  <!-- Main Container -->
  <div class="agent-wrapper">
    <!-- Header -->
    <header class="agent-header">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-desktop"></i>
        </div>
        <div class="logo-text">
          <h1>Remote Agent</h1>
          <span class="tagline">Share your screen securely</span>
        </div>
      </div>
      <div class="header-status" id="headerStatus">
        <span class="status-dot offline"></span>
        <span class="status-text">Not Connected</span>
      </div>
    </header>

    <!-- Login Card -->
    <div id="loginSection" class="glass-card login-card">
      <div class="card-header">
        <div class="card-icon">
          <i class="fas fa-user-shield"></i>
        </div>
        <h2 id="authTitle">Sign In</h2>
        <p id="authSubtitle">Login to start sharing your screen</p>
      </div>

      <!-- Login Form -->
      <form id="loginForm" class="auth-form" onsubmit="event.preventDefault(); login();">
        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <input type="email" id="email" placeholder="Email address" required autocomplete="email">
        </div>

        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-lock"></i>
          </div>
          <input type="password" id="password" placeholder="Password" required autocomplete="current-password">
        </div>

        <button type="submit" class="btn btn-primary btn-glow btn-block">
          <i class="fas fa-sign-in-alt"></i>
          <span>Sign In</span>
        </button>
      </form>

      <!-- Signup Form (hidden by default) -->
      <form id="signupForm" class="auth-form" style="display: none;" onsubmit="event.preventDefault(); signup();">
        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <input type="email" id="signupEmail" placeholder="Email address" required autocomplete="email">
        </div>

        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-lock"></i>
          </div>
          <input type="password" id="signupPassword" placeholder="Password (min 6 characters)" required autocomplete="new-password" minlength="6">
        </div>

        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-lock"></i>
          </div>
          <input type="password" id="signupPasswordConfirm" placeholder="Confirm password" required autocomplete="new-password" minlength="6">
        </div>

        <button type="submit" class="btn btn-primary btn-glow btn-block">
          <i class="fas fa-user-plus"></i>
          <span>Create Account</span>
        </button>
      </form>

      <div class="card-footer">
        <p id="authToggleText">Don't have an account? <a href="#" onclick="showSignup(); return false;" class="link-primary">Create one</a></p>
      </div>

      <div id="loginMessage" class="message-box" style="display: none;"></div>
    </div>

    <!-- Device Status Card -->
    <div id="deviceSection" class="glass-card device-card" style="display: none;">
      <div class="card-header">
        <div class="card-icon pulse-icon">
          <i class="fas fa-broadcast-tower"></i>
        </div>
        <h2>Ready to Share</h2>
        <p>Your device is registered and ready</p>
      </div>

      <!-- Device Info Grid -->
      <div class="device-info-grid">
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-laptop"></i></div>
          <div class="info-content">
            <span class="info-label">Device</span>
            <span class="info-value" id="deviceName">-</span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-globe"></i></div>
          <div class="info-content">
            <span class="info-label">Browser</span>
            <span class="info-value" id="browserInfo">-</span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-user"></i></div>
          <div class="info-content">
            <span class="info-label">User</span>
            <span class="info-value" id="userEmail">-</span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-shield-alt"></i></div>
          <div class="info-content">
            <span class="info-label">Encryption</span>
            <span class="info-value">End-to-End</span>
          </div>
        </div>
      </div>

      <!-- Input Helper Status -->
      <div class="helper-section" id="helperSection">
        <div class="helper-status" id="helperStatus">
          <div class="helper-icon">
            <i class="fas fa-gamepad"></i>
          </div>
          <div class="helper-info">
            <span class="helper-label">Remote Control</span>
            <span class="helper-value" id="helperStatusText">Checking...</span>
          </div>
          <div class="helper-actions">
            <a href="https://github.com/stangtennis/Remote/releases/download/v1.0.0-input-helper/input-helper-v1.0.0.exe" 
               class="btn btn-sm btn-primary" id="downloadHelperBtn" style="display: none;">
              <i class="fas fa-download"></i> Download
            </a>
            <button class="btn btn-sm btn-success" id="helperConnectedBadge" style="display: none;">
              <i class="fas fa-check"></i> Connected
            </button>
          </div>
        </div>
        <p class="helper-hint" id="helperHint" style="display: none;">
          <i class="fas fa-info-circle"></i> 
          Run <code>input-helper.exe</code> to enable remote mouse/keyboard control
        </p>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="startBtn" class="btn btn-success btn-glow btn-lg" onclick="startSharing()">
          <i class="fas fa-play-circle"></i>
          <span>Start Screen Sharing</span>
        </button>
        <button id="stopBtn" class="btn btn-danger btn-lg" onclick="stopSharing()" style="display: none;">
          <i class="fas fa-stop-circle"></i>
          <span>Stop Sharing</span>
        </button>
      </div>

      <!-- Preview Window -->
      <div class="preview-window" id="previewWindow" style="display: none;">
        <div class="preview-header">
          <span><i class="fas fa-eye"></i> Live Preview</span>
          <div class="preview-controls">
            <span class="live-indicator"><span class="live-dot"></span> LIVE</span>
          </div>
        </div>
        <div class="preview-content">
          <video id="preview" autoplay muted playsinline></video>
        </div>
      </div>

      <!-- Logout Button -->
      <div class="card-footer">
        <button class="btn btn-ghost" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Sign Out</span>
        </button>
      </div>
    </div>

    <!-- Connection Request Card -->
    <div id="sessionSection" class="glass-card session-card" style="display: none;">
      <div class="card-header">
        <div class="card-icon ring-animation">
          <i class="fas fa-bell"></i>
        </div>
        <h2>Incoming Connection</h2>
        <p>Someone wants to view your screen</p>
      </div>

      <div class="pin-entry">
        <p class="pin-instruction">Enter the 6-digit PIN to accept</p>
        <div class="pin-input-wrapper">
          <input 
            type="text" 
            id="pinInput" 
            class="pin-input" 
            placeholder="• • • • • •" 
            maxlength="6"
            autocomplete="off"
            inputmode="numeric"
            pattern="[0-9]*"
          >
        </div>
      </div>

      <div class="session-actions">
        <button class="btn btn-success btn-glow" onclick="acceptSession()">
          <i class="fas fa-check-circle"></i>
          <span>Accept</span>
        </button>
        <button class="btn btn-danger" onclick="rejectSession()">
          <i class="fas fa-times-circle"></i>
          <span>Decline</span>
        </button>
      </div>
    </div>

    <!-- Active Session Card -->
    <div id="connectedSection" class="glass-card connected-card" style="display: none;">
      <div class="card-header">
        <div class="card-icon connected-icon">
          <i class="fas fa-link"></i>
        </div>
        <h2>Session Active</h2>
        <p>Your screen is being shared</p>
      </div>

      <!-- Session Stats -->
      <div class="session-stats">
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-clock"></i></div>
          <div class="stat-content">
            <span class="stat-label">Duration</span>
            <span class="stat-value" id="sessionDuration">00:00</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-signal"></i></div>
          <div class="stat-content">
            <span class="stat-label">Connection</span>
            <span class="stat-value" id="connectionQuality">Excellent</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-shield-alt"></i></div>
          <div class="stat-content">
            <span class="stat-label">Security</span>
            <span class="stat-value">Encrypted</span>
          </div>
        </div>
      </div>

      <!-- Live Indicator -->
      <div class="live-banner">
        <span class="live-dot"></span>
        <span>LIVE - Your screen is visible to the remote viewer</span>
      </div>

      <button class="btn btn-danger btn-lg btn-block" onclick="endSession()">
        <i class="fas fa-phone-slash"></i>
        <span>End Session</span>
      </button>
    </div>

    <!-- Footer -->
    <footer class="agent-footer">
      <div class="security-badges">
        <span class="badge"><i class="fas fa-lock"></i> End-to-End Encrypted</span>
        <span class="badge"><i class="fas fa-bolt"></i> WebRTC Powered</span>
        <span class="badge"><i class="fas fa-shield-alt"></i> Secure Connection</span>
      </div>
      <p class="copyright">Remote Desktop © 2025</p>
    </footer>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/web-agent.js"></script>
</body>
</html>
