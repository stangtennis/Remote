<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fjernagent - Del din sk√¶rm</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ•Ô∏è</text></svg>">
  <link rel="stylesheet" href="css/styles.css?v=3">
  <link rel="stylesheet" href="css/loading-states.css?v=3">
  <link rel="stylesheet" href="css/mobile.css?v=3">
  <link rel="stylesheet" href="css/accessibility.css?v=3">
  <link rel="stylesheet" href="css/empty-states.css?v=3">
  <link rel="stylesheet" href="css/modern.css?v=3">
  <script>if(localStorage.getItem('theme')==='light')document.documentElement.setAttribute('data-theme','light');</script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body class="agent-page">
  <!-- Animated Background -->
  <div class="animated-bg">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
    <div class="gradient-orb orb-3"></div>
  </div>

  <!-- Main Container -->
  <div class="agent-wrapper">
    <!-- Header -->
    <header class="agent-header">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-desktop"></i>
        </div>
        <div class="logo-text">
          <h1>Fjernagent</h1>
          <span class="tagline">Del din sk√¶rm sikkert</span>
        </div>
      </div>
      <div class="header-status" id="headerStatus">
        <span class="status-dot offline"></span>
        <span class="status-text">Ikke forbundet</span>
      </div>
    </header>

    <!-- Login Card -->
    <div id="loginSection" class="glass-card login-card">
      <div class="card-header">
        <div class="card-icon">
          <i class="fas fa-user-shield"></i>
        </div>
        <h2 id="authTitle">Log ind</h2>
        <p id="authSubtitle">Log ind for at dele din sk√¶rm</p>
      </div>

      <!-- Login Form -->
      <form id="loginForm" class="auth-form" onsubmit="event.preventDefault(); login();">
        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <input type="email" id="email" placeholder="E-mailadresse" required autocomplete="email">
        </div>

        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-lock"></i>
          </div>
          <input type="password" id="password" placeholder="Adgangskode" required autocomplete="current-password">
        </div>

        <button type="submit" class="btn btn-primary btn-glow btn-block">
          <i class="fas fa-sign-in-alt"></i>
          <span>Log ind</span>
        </button>
      </form>

      <!-- Signup Form (hidden by default) -->
      <form id="signupForm" class="auth-form" style="display: none;" onsubmit="event.preventDefault(); signup();">
        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <input type="email" id="signupEmail" placeholder="E-mailadresse" required autocomplete="email">
        </div>

        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-lock"></i>
          </div>
          <input type="password" id="signupPassword" placeholder="Adgangskode (min 6 tegn)" required autocomplete="new-password" minlength="6">
        </div>

        <div class="input-group">
          <div class="input-icon">
            <i class="fas fa-lock"></i>
          </div>
          <input type="password" id="signupPasswordConfirm" placeholder="Bekr√¶ft adgangskode" required autocomplete="new-password" minlength="6">
        </div>

        <button type="submit" class="btn btn-primary btn-glow btn-block">
          <i class="fas fa-user-plus"></i>
          <span>Opret konto</span>
        </button>
      </form>

      <div class="card-footer">
        <p id="authToggleText">Har du ikke en konto? <a href="#" onclick="showSignup(); return false;" class="link-primary">Opret en</a></p>
      </div>

      <div id="loginMessage" class="message-box" style="display: none;"></div>
    </div>

    <!-- Device Status Card -->
    <div id="deviceSection" class="glass-card device-card" style="display: none;">
      <div class="card-header">
        <div class="card-icon pulse-icon">
          <i class="fas fa-broadcast-tower"></i>
        </div>
        <h2>Klar til deling</h2>
        <p>Din enhed er registreret og klar</p>
      </div>

      <!-- Device Info Grid -->
      <div class="device-info-grid">
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-laptop"></i></div>
          <div class="info-content">
            <span class="info-label">Enhed</span>
            <span class="info-value" id="deviceName">-</span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-globe"></i></div>
          <div class="info-content">
            <span class="info-label">Browser</span>
            <span class="info-value" id="browserInfo">-</span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-user"></i></div>
          <div class="info-content">
            <span class="info-label">Bruger</span>
            <span class="info-value" id="userEmail">-</span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon"><i class="fas fa-shield-alt"></i></div>
          <div class="info-content">
            <span class="info-label">Kryptering</span>
            <span class="info-value">Ende-til-ende</span>
          </div>
        </div>
      </div>

      <!-- Input Helper Status -->
      <div class="helper-section" id="helperSection">
        <div class="helper-status" id="helperStatus">
          <div class="helper-icon">
            <i class="fas fa-gamepad"></i>
          </div>
          <div class="helper-info">
            <span class="helper-label">Fjernstyring</span>
            <span class="helper-value" id="helperStatusText">Tjekker...</span>
          </div>
          <div class="helper-actions">
            <a href="https://downloads.hawkeye123.dk/input-helper.exe" 
               class="btn btn-sm btn-primary" id="downloadHelperBtn" style="display: none;">
              <i class="fas fa-download"></i> Hent
            </a>
            <button class="btn btn-sm btn-success" id="helperConnectedBadge" style="display: none;">
              <i class="fas fa-check"></i> Forbundet
            </button>
          </div>
        </div>
        <p class="helper-hint" id="helperHint" style="display: none;">
          <i class="fas fa-info-circle"></i> 
          K√∏r <code>input-helper.exe</code> for at aktivere fjernmus/tastatur kontrol
        </p>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="startBtn" class="btn btn-success btn-glow btn-lg" onclick="startSharing()">
          <i class="fas fa-play-circle"></i>
          <span>Start sk√¶rmdeling</span>
        </button>
        <button id="stopBtn" class="btn btn-danger btn-lg" onclick="stopSharing()" style="display: none;">
          <i class="fas fa-stop-circle"></i>
          <span>Stop deling</span>
        </button>
      </div>

      <!-- Preview Window -->
      <div class="preview-window" id="previewWindow" style="display: none;">
        <div class="preview-header">
          <span><i class="fas fa-eye"></i> Live forh√•ndsvisning</span>
          <div class="preview-controls">
            <span class="live-indicator"><span class="live-dot"></span> DIREKTE</span>
          </div>
        </div>
        <div class="preview-content">
          <video id="preview" autoplay muted playsinline></video>
        </div>
      </div>

      <!-- Logout Button -->
      <div class="card-footer">
        <button class="btn btn-ghost" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Log ud</span>
        </button>
      </div>
    </div>

    <!-- Waiting for Connection (shown while sharing, before dashboard connects) -->
    <div id="sessionSection" class="glass-card session-card" style="display: none;">
      <div class="card-header">
        <div class="card-icon pulse-icon">
          <i class="fas fa-satellite-dish"></i>
        </div>
        <h2>Venter p√• forbindelse</h2>
        <p>Din sk√¶rm deles ‚Äî √•bn dashboardet og klik "Connect" p√• denne enhed</p>
      </div>
      <div class="live-banner">
        <span class="live-dot"></span>
        <span>Sk√¶rmdeling aktiv ‚Äî venter p√• seer</span>
      </div>
    </div>

    <!-- Active Session Card -->
    <div id="connectedSection" class="glass-card connected-card" style="display: none;">
      <div class="card-header">
        <div class="card-icon connected-icon">
          <i class="fas fa-link"></i>
        </div>
        <h2>Session aktiv</h2>
        <p>Din sk√¶rm deles</p>
      </div>

      <!-- Session Stats -->
      <div class="session-stats">
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-clock"></i></div>
          <div class="stat-content">
            <span class="stat-label">Varighed</span>
            <span class="stat-value" id="sessionDuration">00:00</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-signal"></i></div>
          <div class="stat-content">
            <span class="stat-label">Forbindelse</span>
            <span class="stat-value" id="connectionQuality">Fremragende</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-shield-alt"></i></div>
          <div class="stat-content">
            <span class="stat-label">Sikkerhed</span>
            <span class="stat-value">Krypteret</span>
          </div>
        </div>
      </div>

      <!-- Live Indicator -->
      <div class="live-banner">
        <span class="live-dot"></span>
        <span>DIREKTE - Din sk√¶rm er synlig for fjernseeren</span>
      </div>

      <button class="btn btn-danger btn-lg btn-block" onclick="endSession()">
        <i class="fas fa-phone-slash"></i>
        <span>Afslut session</span>
      </button>
    </div>

    <!-- Footer -->
    <footer class="agent-footer">
      <div class="security-badges">
        <span class="badge"><i class="fas fa-lock"></i> Ende-til-ende krypteret</span>
        <span class="badge"><i class="fas fa-bolt"></i> WebRTC drevet</span>
        <span class="badge"><i class="fas fa-shield-alt"></i> Sikker forbindelse</span>
      </div>
      <p class="copyright">Fjernskrivebord ¬© 2026</p>
    </footer>
  </div>

  <!-- Scripts -->
  <!-- Error Boundary -->
  <script src="js/error-boundary.js?v=3"></script>
  
  <!-- UI Helpers -->
  <script src="js/ui-helpers.js?v=3"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/config.js?v=3"></script>
  <script src="js/web-agent.js?v=3"></script>
</body>
</html>
